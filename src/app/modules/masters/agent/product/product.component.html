<div>
    <div class="overflow-auto flex flex-col max-h-[80vh] rounded border ">
        <div class="flex flex-col overflow-auto max-w-full ">
            <table mat-table [dataSource]="dataSource" class="border-collapse sale-tab" matSort matSortDisableClear
                matSortDirection="desc" matSortActive="entry_date_time" (matSortChange)="refreshItems()">

                <ng-container matColumnDef="options">
                    <th mat-header-cell class="font-bold text-md  min-w-12 max-w-12 w-15 text-center"
                        *matHeaderCellDef>
                        #
                    </th>
                    <td mat-cell *matCellDef="let element" class="border min-w-12 max-w-12 cursor-pointer text-center p-0">
                        <button mat-icon-button (click)="$event.stopPropagation()"
                            [matMenuTriggerFor]="optionMenu" class="sticky left-0 ">
                            <mat-icon> more_vert </mat-icon>
                        </button>
                        <mat-menu #optionMenu>
                            <button mat-menu-item (click)="info(element)">
                                <mat-icon class="mat-18" >info</mat-icon>
                                <span style="font-weight: 600;">Info</span>
                            </button>
                        </mat-menu>
                    </td>
                </ng-container>

                <ng-container matColumnDef="product_name">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-40 max-w-40"
                        *matHeaderCellDef>
                        Product
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b truncate min-w-40 max-w-40" [matTooltip]="element.product_name">
                        {{element.product_name || ' - '}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="itemCount">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-30 max-w-30"
                        *matHeaderCellDef>
                        Items
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b truncate min-w-30 max-w-30">
                        {{element.itemCount ?? ' 0 '}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="count">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-30 max-w-30"
                        *matHeaderCellDef>
                        Installments
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b truncate min-w-30 max-w-30">
                        {{element.count ?? ' 0 '}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="product_status">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-40 max-w-40"
                        *matHeaderCellDef>
                        Status
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b truncate min-w-40 max-w-40" [ngClass]="getStatusColor(element?.product_status)">
                        {{element.product_status || ' - '}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="is_payment_due">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-36 max-w-36"
                        *matHeaderCellDef>
                        Payment Due
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b truncate min-w-36 max-w-36" >
                        <span [matTooltip]="element.is_payment_due" class="max-w-36 truncate min-w-36">{{element.is_payment_due ? 'Yes' : ' No '}}</span>
                    </td>
                </ng-container>

                <ng-container matColumnDef="start_integration">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-40 max-w-40"
                        *matHeaderCellDef>
                        Start Integration
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b truncate min-w-40 max-w-40" >
                        <span [matTooltip]="element.start_integration" class="max-w-40 truncate min-w-40">{{element.start_integration ? 'Yes' : ' No '}}</span>
                    </td>
                </ng-container>

                <ng-container matColumnDef="acivation_date">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-40 max-w-40"
                        *matHeaderCellDef>
                        Activation Date
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b pt-1 min-w-40 max-w-40">
                        <p class="text-md font-medium truncate pr-1 leading-3" >{{ (element.acivation_date | date : "dd-MM-YYYY") || ' - '}}
                        </p>
                    </td>
                </ng-container>

                <ng-container matColumnDef="expiry_date">
                    <th mat-header-cell mat-sort-header class="font-bold text-md min-w-36 max-w-36"
                        *matHeaderCellDef>
                        Expiry Date
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b pt-1 min-w-36 max-w-36">
                        <p class="text-md font-medium truncate pr-1 leading-3" >{{ (element.expiry_date | date : "dd-MM-YYYY") || ' - '}}
                        </p>
                    </td>
                </ng-container>

                <ng-container matColumnDef="entry_date_time">
                    <th mat-header-cell mat-sort-header class="font-bold text-md w-full"
                        *matHeaderCellDef>
                        Entry Date
                    </th>
                    <td mat-cell *matCellDef="let element" class="border-b pt-1 w-full">
                        <p class="text-md font-medium truncate pr-1 leading-3" >{{ (element.entry_date_time | date : "dd-MM-YYYY") || ' - '}}
                        </p>
                    </td>
                </ng-container>


                <tr class="h-9 min-h-9 sticky top-0 z-10" mat-header-row *matHeaderRowDef="columns; sticky: true"></tr>
                <tr class="h-9 border-0" mat-row *matRowDef="let row; columns: columns"></tr>
            </table>
        </div>
        <div class="flex flex-col justify-center items-center w-full h-80" *ngIf=" dataSource.data.length <= 0">
            <div class="flex flex-row items-center space-x-4" *ngIf="loading">
                <mat-progress-spinner [diameter]="24" [mode]="'indeterminate'"></mat-progress-spinner>
                <span class="text-xl">Loading...</span>
            </div>
            <div class="flex flex-col items-center justify-center" *ngIf="!loading">
                <p >No data to display!</p>
                <div class="text-secondary flex flex-col justify-center items-center text-md"
                    *ngIf="searchInputControl.value">
                    <span>no search results found for "<b>{{searchInputControl.value}}</b>".</span>
                </div>
            </div>
        </div>
        <mat-paginator class="second-color z-10 sticky w-full bottom-0 " #paginator
            [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="10" (page)="refreshItems()" showFirstLastButtons>
        </mat-paginator>
    </div>
</div>
