<div class="flex flex-col min-w-128 max-w-128 max-h-screen -m-6">

    <!-- Header -->
    <div class="px-6 bg-primary">
        <div class="flex flex-0 items-center justify-between h-14">
            <div class="text-lg text-white">Change Password</div>
            <mat-icon svgIcon="close" class="text-white icon-size-7 cursor-pointer" (click)="matDialogRef.close()"></mat-icon>
        </div>
    </div>

    <div class="px-6 pb-6 pt-3">
        <!-- Alert -->
        <fuse-alert class="mt-4" *ngIf="showAlert" [appearance]="'outline'" [showIcon]="false" [type]="alert.type"
            [@shake]="alert.type === 'error'">
            <span [innerHTML]="alert.message"></span>
            <!-- {{alert.message}} -->
        </fuse-alert>

        <!-- Sign in form -->
        <form class="mt-2 space-y-4" [formGroup]="setPassForm">
            <!-- Old field -->
            <mat-form-field class="w-full">
                <input id="oldPassword" matInput type="password" placeholder="Old Password" [formControlName]="'oldPassword'" #oldPassword>
                <button mat-icon-button class="relative right-0" type="button"
                    (click)="oldPassword.type === 'password' ? oldPassword.type = 'text' : oldPassword.type = 'password'"
                    matSuffix>
                    <mat-icon class="icon-size-5" *ngIf="oldPassword.type === 'password'"
                        [svgIcon]="'heroicons_solid:eye'"></mat-icon>
                    <mat-icon class="icon-size-5" *ngIf="oldPassword.type === 'text'"
                        [svgIcon]="'heroicons_solid:eye-slash'"></mat-icon>
                </button>
                <mat-error *ngIf="setPassForm.get('oldPassword').hasError('required')">
                    Old Password is required
                </mat-error>
            </mat-form-field>

            <!-- Pass field -->
            <mat-form-field class="w-full">
                <input id="password" matInput type="password" placeholder="New Password" [formControlName]="'password'"
                    #passwordField pattern="^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#$%^&*]).{8,}$">
                <button mat-icon-button class="relative right-0" type="button"
                    (click)="passwordField.type === 'password' ? passwordField.type = 'text' : passwordField.type = 'password'"
                    matSuffix>
                    <mat-icon class="icon-size-5" *ngIf="passwordField.type === 'password'"
                        [svgIcon]="'heroicons_solid:eye'"></mat-icon>
                    <mat-icon class="icon-size-5" *ngIf="passwordField.type === 'text'"
                        [svgIcon]="'heroicons_solid:eye-slash'"></mat-icon>
                </button>
                <mat-error *ngIf="setPassForm.get('password').hasError('required')">
                    New Password is required
                </mat-error>
                <mat-error
                    *ngIf="!regex(setPassForm.get('password').value) && !setPassForm.get('password').hasError('required')">
                    Password must contain 1 upper case, 1 lower case, 1 number & 1 special character and must be 8
                    digits long.
                </mat-error>
            </mat-form-field>

            <mat-form-field class="w-full">
                <input id="passwordConfirm" matInput type="password" placeholder="Confirm Password"
                    [formControlName]="'passwordConfirm'" #ConfirmpasswordField>
                <button mat-icon-button class="relative right-0" type="button"
                    (click)="ConfirmpasswordField.type === 'password' ? ConfirmpasswordField.type = 'text' : ConfirmpasswordField.type = 'password'"
                    matSuffix>
                    <mat-icon class="icon-size-5" *ngIf="ConfirmpasswordField.type === 'password'"
                        [svgIcon]="'heroicons_solid:eye'"></mat-icon>
                    <mat-icon class="icon-size-5" *ngIf="ConfirmpasswordField.type === 'text'"
                        [svgIcon]="'heroicons_solid:eye-slash'"></mat-icon>
                </button>

                <mat-error *ngIf="setPassForm.get('passwordConfirm').hasError('required')">
                    Confirm Password is required
                </mat-error>
                <mat-error
                    *ngIf="setPassForm.get('passwordConfirm').errors && setPassForm.get('passwordConfirm').errors.confirmPasswordValidator">
                    Password and Confirm Password do not match.
                </mat-error>
            </mat-form-field>

            <div class="flex justify-end">
                <button (click)="setPass()" mat-flat-button [color]="'primary'" *ngIf="!setPassForm.disabled"  [disabled]="setPassForm.disabled">
                    Save
                </button>
            </div>
        </form>
    </div>
</div>
