<div class="sm:absolute sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden dark:bg-transparent">

    <!-- Header -->
    <div
        class="relative flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between py-4 px-6 md:px-8   -b">
        <!-- Title -->
        <div class="text-3xl font-extrabold tracking-tight">{{module_name}}</div>
        <!-- Actions -->
        <div class="flex shrink-0 items-center mt-6 sm:mt-0 sm:ml-4">
            <!-- Search -->
            <mat-form-field class="fuse-mat-dense fuse-mat-rounded min-w-64" [subscriptSizing]="'dynamic'">
                <mat-icon class="icon-size-5" matPrefix [svgIcon]="'heroicons_solid:magnifying-glass'"></mat-icon>
                <input matInput [formControl]="searchInternalFilter" [autocomplete]="'off'" [placeholder]="'Search'">
            </mat-form-field>

            <!-- Add product button -->
            <button class="ml-4" mat-flat-button [color]="'primary'" (click)="filter()">
                <mat-icon class="w-10 h-10">filter_alt</mat-icon>
                <span class="">Filter</span>
            </button>

            <button mat-raised-button [color]="'primary'" [matMenuTriggerFor]="menu" class="ml-4">
                <mat-icon class="icon-size-6">more_vert</mat-icon>
            </button>
            <mat-menu #menu>
                <button mat-menu-item (click)="exportExcel()">
                    <mat-icon>arrow_downward</mat-icon>
                    <span>Export Excel</span>
                </button>
            </mat-menu>

            <button class="ml-4" mat-flat-button [disabled]="loading" (click)="refreshItems()" [color]="'primary'">
                <mat-icon class="icon-size-4.5" svgIcon="feather:refresh-ccw"></mat-icon>
            </button>
        </div>
    </div>



    <div class="flex flex-col flex-auto overflow-hidden ">
        <!-- list -->
        <div class="overflow-auto flex flex-col">
            <div class="flex flex-col overflow-auto max-w-full h-full rounded-b-lg"
               >
                <table mat-table [dataSource]="dataSource" class="sale-tab" matSort matSortDisableClear
                    matSortDirection="desc" matSortActive="booking_date" >
                    <ng-container matColumnDef="action" [sticky]="true">
                        <th mat-header-cell class="font-bold text-md text-center p-0  max-w-10 min-w-10" *matHeaderCellDef>#</th>
                        <td mat-cell *matCellDef="let element" class="  max-w-10 min-w-10 dark:bg-gray-900 bg-[#f8fafc]">
                            <div class="flex items-center justify-center">
                                <button mat-icon-button [matMenuTriggerFor]="optionMenu" class="sticky left-0">
                                    <mat-icon> more_vert </mat-icon>
                                </button>
                            </div>
                            <!-- <mat-menu #optionMenu>
                                <button mat-menu-item (click)="info(element)">
                                    <mat-icon class="mat-18">info</mat-icon>
                                    <span style="font-weight: 600">Info</span>
                                </button>
                                <mat-divider></mat-divider>
                            </mat-menu> -->
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="agent_code">
                        <th mat-header-cell mat-sort-header class="font-bold text-md truncate   min-w-30 max-w-30" *matHeaderCellDef>
                            Agent Code
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-30 max-w-30">
                            <span class=" px-1 flex items-center min-w-20 rounded-md w-fit text-md truncate font-medium">
                                <span>{{ element.agent_code }} </span>
                            </span>
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="agent_gst_no">
                        <th mat-header-cell mat-sort-header class="font-bold text-md truncate   min-w-40 max-w-40"
                            *matHeaderCellDef>
                            Agent GST No.
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-40 max-w-40">
                            <p class="text-md  font-medium truncate pr-1  " [matTooltip]="element.agent_gst_no">
                                {{ element.agent_gst_no || ' - ' }}
                            </p>
                        </td>
                    </ng-container>

                    <!-- <ng-container matColumnDef="agent">
                        <th mat-header-cell class="font-bold text-md truncate   min-w-50 max-w-50"
                            *matHeaderCellDef>
                            agent
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-50 max-w-50  ">
                            <p class="text-md  font-medium truncate pr-1  " >
                                {{ element.agent }}
                            </p>
                        </td>
                    </ng-container> -->
    
                    <ng-container matColumnDef="agent_pan_no">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-40 max-w-40" *matHeaderCellDef>
                            Agent PAN No.
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-40 max-w-40">
                            <p class="text-md  font-medium pr-1 truncate" [matTooltip]="element.agent_pan_no">
                                {{ element.agent_pan_no || ' - ' }}
                            </p>
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="agent_pincode">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-36 max-w-36" *matHeaderCellDef>
                            Agent Pincode
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-36 max-w-36">
                            <p class="text-md  font-medium truncate pr-1" >
                                {{ element.agent_pincode }}
                            </p>
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="agent_state">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-40 max-w-40"
                            *matHeaderCellDef>
                            Agent State
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-40 max-w-40">
                            <p class="text-md truncate font-medium">
                                {{ element.agent_state }} 
                            </p>
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="billing_company">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-44 max-w-44" *matHeaderCellDef>
                            Billing Company
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-44 max-w-44">
                            <p class="text-md truncate font-medium" [matTooltip]="element.billing_company">
                                {{ element.billing_company }}
                            </p>
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="booking_currency">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-44 max-w-44" *matHeaderCellDef>
                            Booking Currency
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-44 max-w-44">
                            <p class="text-md truncate font-medium">
                                {{element.booking_currency}}
                            </p>
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="booking_date">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-32 max-w-32" *matHeaderCellDef>
                            Booking Date
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{ element.booking_date | date : "dd-MM-yyyy"}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="booking_ref_no">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-50 max-w-50" *matHeaderCellDef>
                            Booking Reference No.
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-50 max-w-50">
                            <p class="text-md truncate font-medium" [matTooltip]="element.booking_ref_no">
                                {{element.booking_ref_no}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="booking_type">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-32 max-w-32" *matHeaderCellDef>
                            Booking Type
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.booking_type}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="cgst">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-22 max-w-22" *matHeaderCellDef>
                            CGST
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-22 max-w-22">
                            <p class="text-md truncate font-medium">
                                {{element.cgst}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="commission_given">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-40 max-w-40" *matHeaderCellDef>
                            Commission Given
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-40 max-w-40">
                            <p class="text-md truncate font-medium">
                                {{element.commission_given}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="commission_income">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-48 max-w-48" *matHeaderCellDef>
                            Commission Income
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-48 max-w-48">
                            <p class="text-md truncate font-medium">
                                {{element.commission_income ? element.commission_income.toFixed(2) : ' 0 '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="commission_passedon">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-48 max-w-48" *matHeaderCellDef>
                            Commission Passed On
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-48 max-w-48">
                            <p class="text-md truncate font-medium">
                                {{element.commission_passedon}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="destination">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-32 max-w-32" *matHeaderCellDef>
                            Destination
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.destination}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="gds_pnr">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-22 max-w-22" *matHeaderCellDef>
                            GDS PNR
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-22 max-w-22">
                            <p class="text-md truncate font-medium" >
                                {{element.gds_pnr || ' - '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="gst_number_passed_to_supplier">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-60 max-w-60" *matHeaderCellDef>
                            GST Number Passed To Supplier
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-60 max-w-60">
                            <p class="text-md truncate font-medium">
                                {{element.gst_number_passed_to_supplier || ' - '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="igst">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-22 max-w-22" *matHeaderCellDef>
                            IGST
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-22 max-w-22">
                            <p class="text-md truncate font-medium">
                                {{element.igst}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="inquiry_date">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-32 max-w-32" *matHeaderCellDef>
                            Inquiry Date
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{(element.inquiry_date | date:'dd-MM-yyyy') || ' - '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="invoice_date">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-32 max-w-32" *matHeaderCellDef>
                            Invoice Date
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{(element.invoice_date | date:'dd-MM-yyyy') || ' - '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="invoice_no">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-40 max-w-40" *matHeaderCellDef>
                            Invoice No.
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-40 max-w-40">
                            <p class="text-md truncate font-medium">
                                {{element.invoice_no}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="master_agent">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-48 max-w-48" *matHeaderCellDef>
                            Agent
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-48 max-w-48">
                            <p class="text-md truncate font-medium" [matTooltip]="element.master_agent">
                                {{element.master_agent}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="net_purchase">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-32 max-w-32" *matHeaderCellDef>
                            Net Purchase
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.net_purchase ? element.net_purchase.toFixed(2) : ' 0 ' }}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="pax">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-22 max-w-22" *matHeaderCellDef>
                            Pax
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-22 max-w-22">
                            <p class="text-md truncate font-medium">
                                {{element.pax}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="pnr">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-22 max-w-22" *matHeaderCellDef>
                            PNR
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-22 max-w-22">
                            <p class="text-md truncate font-medium">
                                {{element.pnr || ' - '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="purchase_amount">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-40 max-w-40" *matHeaderCellDef>
                            Purchase Amount
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-40 max-w-40">
                            <p class="text-md truncate font-medium">
                                {{element.purchase_amount ? element.purchase_amount.toFixed(2) : ' 0 '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="roe">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-22 max-w-222" *matHeaderCellDef>
                            ROE
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-22 max-w-22">
                            <p class="text-md truncate font-medium">
                                {{element.roe}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="sale_price">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-32 max-w-32" *matHeaderCellDef>
                            Sale Price
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.sale_price}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="sales_type">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-32 max-w-32" *matHeaderCellDef>
                            Sales Type
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.sales_type}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="service_charge">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-36 max-w-36" *matHeaderCellDef>
                            Service Charge
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-36 max-w-36">
                            <p class="text-md truncate font-medium">
                                {{element.service_charge}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="service_charge_tax">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-40 max-w-40" *matHeaderCellDef>
                            Service Charge Tax
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-40 max-w-40">
                            <p class="text-md truncate font-medium">
                                {{element.service_charge_tax}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="service_type">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-32 max-w-32" *matHeaderCellDef>
                            Service Type
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.service_type}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="sgst">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-22 max-w-22" *matHeaderCellDef>
                            SGST
                        </th>
                        <td mat-cell *matCellDef="let element" class="   min-w-22 max-w-22">
                            <p class="text-md truncate font-medium">
                                {{element.sgst}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="supplier">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-40 max-w-40" *matHeaderCellDef>
                            Supplier
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-40 max-w-40">
                            <p class="text-md truncate font-medium">
                                {{element.supplier}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="supplier_invoice_number">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-48 max-w-48" *matHeaderCellDef>
                            Supplier Invoice No.
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-48 max-w-48">
                            <p class="text-md truncate font-medium">
                                {{element.supplier_invoice_number || ' - '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="tds_on_commission_given">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-50 max-w-50" *matHeaderCellDef>
                            Tds On Commission Given
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-50 max-w-50">
                            <p class="text-md truncate font-medium">
                                {{element.tds_on_commission_given}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="tds_on_commission_income">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-56 max-w-56" *matHeaderCellDef>
                            TDS On Commission Income
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-56 max-w-56">
                            <p class="text-md truncate font-medium">
                                {{element.tds_on_commission_income ? element.tds_on_commission_income.toFixed(2) : ' 0 '}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="tds_on_commission_passedon">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate   min-w-60 max-w-60" *matHeaderCellDef>
                            TDS On Commission Passed On
                        </th>
                        <td mat-cell *matCellDef="let element" class=" min-w-60 max-w-60">
                            <p class="text-md truncate font-medium">
                                {{element.tds_on_commission_passedon}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="ticket_status">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-32 max-w-32" *matHeaderCellDef>
                            Ticket Status
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.ticket_status}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="travel_date">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-32 max-w-32" *matHeaderCellDef>
                            Travel Date
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.travel_date | date: 'dd-MM-yyyy'}}
                            </p>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="travel_type">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-32 max-w-32" *matHeaderCellDef>
                            Travel Type
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.travel_type}}
                            </p>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="payment_mode">
                        <th mat-header-cell mat-sort-header
                            class="font-bold text-md truncate min-w-32 max-w-32" *matHeaderCellDef>
                            Payment Mode
                        </th>
                        <td mat-cell *matCellDef="let element" class="min-w-32 max-w-32">
                            <p class="text-md truncate font-medium">
                                {{element.payment_mode || ' - '}}
                            </p>
                        </td>
                    </ng-container>
    
                    <tr class="h-9 min-h-9 sticky top-0  z-10" mat-header-row *matHeaderRowDef="columns; sticky: true"></tr>
                    <tr class="h-9 " mat-row *matRowDef="let row; columns: columns"></tr>
                </table>
            </div>
            
            <div *ngIf="dataSource.filteredData.length <= 0">
                <div class="p-8 sm:p-16  text-3xl tracking-tight text-center pt-20">
                    {{getNodataText()}}
                </div>
            </div>

            <mat-paginator class="absolute z-10  w-full bottom-0 border-t dark:bg-gray-900 " #_paginator
                [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="10"  showFirstLastButtons>
            </mat-paginator>
        </div>

    </div>

</div>