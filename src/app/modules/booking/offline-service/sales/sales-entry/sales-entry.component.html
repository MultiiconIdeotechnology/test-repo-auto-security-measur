<div class="flex flex-col max-w-200 md:min-w-200 max-h-screen -m-6">

    <!-- Header -->
    <div class="flex flex-0 items-center justify-between h-16 pr-3 sm:pr-5 pl-6 sm:pl-8 bg-primary">
        <div class="text-lg font-medium text-white">{{title}}</div>
        <button mat-icon-button (click)="matDialogRef.close()" [tabIndex]="-1">
            <mat-icon class="text-current text-white" [svgIcon]="'heroicons_outline:x-mark'"></mat-icon>
        </button>
    </div>

    <form class="flex flex-col flex-auto px-6 pt-6 overflow-y-auto max-h-120" [formGroup]="formGroup"
        *ngIf="!readonly; else detailView">

        <div class="flex flex-row gap-3">
            <mat-form-field class="flex-grow">
                <mat-label>Service Type</mat-label>
                <mat-select required formControlName="service_type">
                    <mat-option *ngFor="let list of serviceList" [value]="list.value">
                        {{ list.viewValue }}
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field class="flex-grow">
                <mat-label>Currency</mat-label>
                <input matInput type="text" formControlName="currency" required readonly>
            </mat-form-field>
        </div>

        <div class="flex flex-row gap-3">
            <mat-form-field class="flex-grow w-1/2">
                <mat-label>Sale Amount</mat-label>
                <input matInput type="number" formControlName="sale_amount" [min]="1" required>
            </mat-form-field>

            <mat-form-field class="flex-grow w-1/2">
                <mat-label>Service Charge</mat-label>
                <input matInput type="number" formControlName="service_charge" [min]="0" required>
            </mat-form-field>

            <mat-form-field class="flex-grow w-1/2">
                <mat-label>Total Tax</mat-label>
                <input matInput type="number" formControlName="total_tax" [min]="0" required>
            </mat-form-field>

            <mat-form-field class="flex-grow w-1/2">
                <mat-label>Net Sale</mat-label>
                <input matInput type="number"
                    [value]="formGroup.get('sale_amount').value + formGroup.get('service_charge').value + formGroup.get('total_tax').value"
                    required readonly>
            </mat-form-field>
        </div>

        <div class="flex flex-row gap-3">
            <mat-form-field class="flex-grow w-1/2" *ngIf="currency_short_code.toLowerCase() == 'inr'">
                <mat-label>SGST</mat-label>
                <input matInput type="number" formControlName="sgst">
            </mat-form-field>

            <mat-form-field class="flex-grow w-1/2" *ngIf="currency_short_code.toLowerCase() == 'inr'">
                <mat-label>CGST</mat-label>
                <input matInput type="number" formControlName="cgst">
            </mat-form-field>

            <mat-form-field class="flex-grow w-1/2" *ngIf="currency_short_code.toLowerCase() == 'inr'">
                <mat-label>IGST</mat-label>
                <input matInput type="number" formControlName="igst">
            </mat-form-field>

            <mat-form-field class="flex-grow w-1/2" *ngIf="currency_short_code.toLowerCase() != 'inr'">
                <mat-label>VAT</mat-label>
                <input matInput type="number" formControlName="vat">
            </mat-form-field>
        </div>

        <div class="flex flex-row gap-3">
            <mat-form-field class="flex-grow w-1/3">
                <mat-label>Service Date</mat-label>
                <input matInput readonly [matDatepicker]="picker1" required formControlName="service_date">
                <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>

            <mat-form-field class="flex-grow w-full">
                <mat-label>Service Particular</mat-label>
                <input matInput formControlName="service_particular" required>
            </mat-form-field>
        </div>

        <mat-form-field class="flex-grow">
            <mat-label>Service Remark</mat-label>
            <textarea matInput formControlName="service_remark" class="min-h-22" required></textarea>
        </mat-form-field>

    </form>

    <ng-template #detailView>
        <div class="grid grid-cols-4 gap-4 p-8 pb-4 bg-card rounded-2xl overflow-hidden min-w-180">
            <div class="flex flex-col mb-3" *ngFor="let filed of fieldList" [class.hidden]="filed.isHide" [style]="filed.name == 'Service Particular' || filed.name == 'Service Remark' ? 'grid-column: 1 / 5;' : ''">
                <div class="flex flex-row space-x-2">
                    <span class="text-md font-semibold text-secondary">{{
                        filed.name
                        }}</span>
                    <mat-icon *ngIf="filed.show_info" [matTooltip]="filed.info_tooltip">info</mat-icon>
                </div>
                <span class="flex items-center">
                    <span class="text-base" [ngClass]="filed.name == 'Service Particular' || filed.name == 'Service Remark' ? '' : 'truncate'" [matTooltip]="filed.isTooltip ? filed.value : ''">{{
                        filed.value || "--" }}</span>
                </span>
            </div>
        </div>
    </ng-template>

    <div class="flex items-center justify-end mt-4 sm:mt-0 pr-6 pb-4 space-x-3">
        <button mat-flat-button [color]="'primary'" (click)="submit()" *ngIf="!readonly" [disabled]="disableBtn">
            {{btnLabel}}
        </button>
    </div>
</div>